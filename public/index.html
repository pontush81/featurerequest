<!DOCTYPE html>
<html lang="sv">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Önskemål</title>
    <link rel="stylesheet" href="css/styles.css">
    <link rel="icon" type="image/png" href="https://www.kontek.se/favicon.ico">
</head>
<body>
    <header>
        <h1>Önskemål</h1>
        <p class="subtitle">Skicka in dina önskemål</p>
    </header>
    
    <main>
        <form id="requestForm">
            <div class="form-group">
                <label for="project">Välj område (exempel):</label>
                <select id="project" name="project" required>
                    <option value="">Välj område</option>
                    <option value="Kontek Lön">Kontek Lön</option>
                    <option value="Kontek HRM">Kontek HRM</option>
                    <option value="Interna verktyg">Interna verktyg</option>
                </select>
            </div>

            <div class="form-group">
                <label for="title">Titel</label>
                <input type="text" id="title" name="title" required>
            </div>

            <div class="form-group">
                <label for="description">Beskrivning</label>
                <textarea id="description" name="description" required placeholder="Example:

As a project manager, I want to be able to filter tasks by assignee so that I can quickly see what each team member is working on.

Background:

Currently, we can only see all tasks in a list, making it difficult to track individual workloads."></textarea>
            </div>

            <div class="form-group">
                <label for="acceptanceCriteria">Acceptanskriterier</label>
                <textarea id="acceptanceCriteria" name="acceptanceCriteria" required placeholder="List specific, testable conditions that must be met. Example:

1. A dropdown filter for assignees is available in the task list view
2. The filter shows all team members who have tasks assigned
3. Selecting an assignee immediately updates the task list
4. The filter persists when navigating away and back
5. A 'Clear Filter' option is available"></textarea>
            </div>

            <div class="form-group">
                <label for="businessValue">Affärsvärde</label>
                <textarea id="businessValue" name="businessValue" required placeholder="Explain the value this brings to the business"></textarea>
            </div>

            <div class="form-group">
                <h3>Business Value Categories (PRAISED)</h3>
                <p class="subtext">Rate each category from 0 (no impact) to 4 (highest impact)</p>
                
                <div class="praised-grid">
                    <div class="praised-item">
                        <label>
                            <input type="checkbox" name="praised_productivity" id="praised_productivity">
                            Productivity gains
                        </label>
                        <select name="productivity_rating" id="productivity_rating">
                            <option value="0">0 - No impact</option>
                            <option value="1">1 - Minor impact</option>
                            <option value="2">2 - Moderate impact</option>
                            <option value="3">3 - High impact</option>
                            <option value="4">4 - Highest impact</option>
                        </select>
                    </div>

                    <div class="praised-item">
                        <label>
                            <input type="checkbox" name="praised_reduced" id="praised_reduced">
                            Reduced costs
                        </label>
                        <select name="reduced_rating" id="reduced_rating">
                            <option value="0">0 - No impact</option>
                            <option value="1">1 - Minor impact</option>
                            <option value="2">2 - Moderate impact</option>
                            <option value="3">3 - High impact</option>
                            <option value="4">4 - Highest impact</option>
                        </select>
                    </div>

                    <div class="praised-item">
                        <label>
                            <input type="checkbox" name="praised_avoided" id="praised_avoided">
                            Avoided costs
                        </label>
                        <select name="avoided_rating" id="avoided_rating">
                            <option value="0">0 - No impact</option>
                            <option value="1">1 - Minor impact</option>
                            <option value="2">2 - Moderate impact</option>
                            <option value="3">3 - High impact</option>
                            <option value="4">4 - Highest impact</option>
                        </select>
                    </div>

                    <div class="praised-item">
                        <label>
                            <input type="checkbox" name="praised_increased" id="praised_increased">
                            Increased revenue
                        </label>
                        <select name="increased_rating" id="increased_rating">
                            <option value="0">0 - No impact</option>
                            <option value="1">1 - Minor impact</option>
                            <option value="2">2 - Moderate impact</option>
                            <option value="3">3 - High impact</option>
                            <option value="4">4 - Highest impact</option>
                        </select>
                    </div>

                    <div class="praised-item">
                        <label>
                            <input type="checkbox" name="praised_service" id="praised_service">
                            Service level improvements
                        </label>
                        <select name="service_rating" id="service_rating">
                            <option value="0">0 - No impact</option>
                            <option value="1">1 - Minor impact</option>
                            <option value="2">2 - Moderate impact</option>
                            <option value="3">3 - High impact</option>
                            <option value="4">4 - Highest impact</option>
                        </select>
                    </div>

                    <div class="praised-item">
                        <label>
                            <input type="checkbox" name="praised_enhanced" id="praised_enhanced">
                            Enhanced quality
                        </label>
                        <select name="enhanced_rating" id="enhanced_rating">
                            <option value="0">0 - No impact</option>
                            <option value="1">1 - Minor impact</option>
                            <option value="2">2 - Moderate impact</option>
                            <option value="3">3 - High impact</option>
                            <option value="4">4 - Highest impact</option>
                        </select>
                    </div>

                    <div class="praised-item">
                        <label>
                            <input type="checkbox" name="praised_differentiation" id="praised_differentiation">
                            Differentiation in the marketplace
                        </label>
                        <select name="differentiation_rating" id="differentiation_rating">
                            <option value="0">0 - No impact</option>
                            <option value="1">1 - Minor impact</option>
                            <option value="2">2 - Moderate impact</option>
                            <option value="3">3 - High impact</option>
                            <option value="4">4 - Highest impact</option>
                        </select>
                    </div>
                </div>
                <p class="subtext">Select and rate applicable business value categories for this request.</p>
            </div>

            <div class="form-group">
                <h3>Business Value Summary</h3>
                <div class="business-value-summary">
                    <div class="total-score">
                        <span>Total Score: </span>
                        <span id="totalScore">0</span>
                    </div>
                    <div class="categories-summary" id="categoriesSummary">
                        <!-- Filled by JavaScript -->
                    </div>
                </div>
            </div>

            <div class="form-group">
                <label for="priority">Prioritet</label>
                <select id="priority" name="priority" required>
                    <option value="">Välj prioritet</option>
                    <option value="Låg">Låg</option>
                    <option value="Medium">Medium</option>
                    <option value="Hög">Hög</option>
                </select>
            </div>

            <div class="form-group">
                <label for="requesterName">Ditt namn</label>
                <input type="text" id="requesterName" name="requesterName" required>
            </div>

            <div class="form-group">
                <label for="requesterEmail">Din e-post</label>
                <input type="email" id="requesterEmail" name="requesterEmail" required>
            </div>

            <input type="hidden" id="submissionDate" name="submissionDate">

            <div class="form-actions">
                <button type="submit" class="btn-primary">Skicka önskemål</button>
            </div>
        </form>

        <div id="statusMessage" class="status-message"></div>
        
        <div id="requestsList">
            <h2>Inskickade önskemål</h2>
            <div id="requestsTableContainer"></div>
        </div>
    </main>

    <footer>
        <p>Kontek Feature Request Portal &copy; 2024</p>
    </footer>

    <script src="js/main.js"></script>
    <script>
        const categories = [
            { id: 'productivity', name: 'Productivity gains' },
            { id: 'reduced', name: 'Reduced costs' },
            { id: 'avoided', name: 'Avoided costs' },
            { id: 'increased', name: 'Increased revenue' },
            { id: 'service', name: 'Service level improvements' },
            { id: 'enhanced', name: 'Enhanced quality' },
            { id: 'differentiation', name: 'Differentiation in the marketplace' }
        ];

        function updateBusinessValueSummary() {
            const totalScoreElement = document.getElementById('totalScore');
            const categoriesSummaryElement = document.getElementById('categoriesSummary');
            let totalScore = 0;
            
            // Collect scores for each category
            const categoryScores = categories.map(category => {
                const checkbox = document.getElementById(`praised_${category.id}`);
                const select = document.getElementById(`${category.id}_rating`);
                const score = checkbox && checkbox.checked ? parseInt(select.value) : 0;
                totalScore += score;
                return {
                    name: category.name,
                    score: score
                };
            });

            // Update total score
            totalScoreElement.textContent = totalScore;

            // Sort categories by score (highest first) and create summary HTML
            const sortedCategories = categoryScores
                .sort((a, b) => b.score - a.score)
                .map(category => {
                    const noImpactClass = category.score === 0 ? 'no-impact' : '';
                    return `
                        <div class="category-item ${noImpactClass}">
                            <span class="category-name">${category.name}</span>
                            <span class="category-score">${category.score}</span>
                        </div>
                    `;
                })
                .join('');

            categoriesSummaryElement.innerHTML = sortedCategories;
        }

        // Add event listeners to all checkboxes and selects
        categories.forEach(category => {
            const checkbox = document.getElementById(`praised_${category.id}`);
            const select = document.getElementById(`${category.id}_rating`);
            
            if (checkbox && select) {
                checkbox.addEventListener('change', updateBusinessValueSummary);
                select.addEventListener('change', updateBusinessValueSummary);
            }
        });

        // Initial update
        updateBusinessValueSummary();
    </script>
</body>
</html>